# 所有接口

| 序号 | 方法   | 接口                                                         | 表单                                                         | 菜单                                   |描述|
| ---- | ------ | ------------------------------------------------------------ | ------------------------------------------------------------ | -------------------------------------- |----|
| 1.    | GET    | /apis/linkingthing.com/example/v1/hists                    | 无                                                           | 节点管理=>DNS节点的历史信息查询                           |需要添加URL参数:node=10.0.0.19&start=1582699483&end=1582701261&step=323&type=qps
| 2.    | GET    | /apis/linkingthing.com/example/v1/nodes                   | 无                                                           | 节点管理=>DNS节点的信息查询                           |需要添加URL参数:node=10.0.0.15&type=cpu

# 接口详细描述
## 1. 节点历史信息查询
- 接口信息  

|接口描述|获取视图信息|
|-|-|
|请求地址|/apis/linkingthing.com/example/v1/hists?node=10.0.0.19&start=1582699483&end=1582701261&step=323&type=qps|
|请求方式|HTTP/1.1 GET|
|返回格式|JSON|

- 请求参数意义

|参数名称key|参数value|是否必填|数据类型|备注|
| - |-|-|-|-|
|type|qps|是|字符串|表示qps主题的内容,其他的主题还有cpu,mem,disk,querys,memhit,recurquerys,分别表示cpu利用率，内存利用率，磁盘利用率,域名解析次数查询,内存命中次数查询,递归次数查询|
|node|10.0.0.19|是|字符串|dns服务器的ip|
|start|1582684206.097|是|字符串|查询开始时间戳|
|end|1582684506.097|是|字符串|查询结束时间戳|
|step|10|是|字符串|查询时间间隔,单位秒|



- 请求示例

|请求内容|http://10.0.0.19:1210/apis/linkingthing.com/example/v1/hists?node=10.0.0.19&start=1582699483&end=1582701261&step=323&type=qps|
|-|-|
|响应内容|如下引用|

```
{
	"status": "success",
	"data": {
		"metric": {
			"node": "10.0.0.19"
		},
		"values": [
			[1582699483, "0"],
			[1582699806, "0"],
			[1582700129, "0"],
			[1582700452, "0"],
			[1582700775, "0"],
			[1582701098, "0"]
		]
	},
	"message": "ok"
}
```
界面元素|响应参数位置|参数类型|参数值举例|
- | -|-|-|
点xy坐标|{"data":{"values": [[1582684206.097, "0"]]}}|string|1582699483, "0"|

## 2. 节点信息查询
- 接口信息  

|接口描述|获取视图信息|
|-|-|
|请求地址|/apis/linkingthing.com/example/v1/nodes?node=10.0.0.15&type=cpu|
|请求方式|HTTP/1.1 GET|
|返回格式|JSON|

- 请求参数意义

|参数名称key|参数value|是否必填|数据类型|备注|
| - |-|-|-|-|
|node|10.0.0.19|是|字符串|进入首页是不传，其他情况传ip地址即可（如10.0.0.15）|
|type|cpu|是|字符串|取值（cpu, mem, disk, all）不传参数，默认是all，不传即可



- 请求示例

|请求内容|http://10.0.0.19:8081/apis/linkingthing.com/example/v1/nodes?node=10.0.0.15&type=cpu|
|-|-|
|响应内容|如下引用|

```
{
	"status": "success",
	"data": {
		"nodes": {},
		"usage": {
			"10.0.0.15": {
				"cpu": "67.40",
				"mem": "29.85",
				"disk": "49.36",
				"qps": "39.76"
			}
		}
	},
	"message": "ok"
}
```
界面元素|响应参数位置|参数类型|参数值举例|
- | -|-|-|
点xy坐标|{"data":{"values": [[1582684206.097, "0"]]}}|string|1582699483, "0"|


## 3. 返回状态信息查询
- 接口信息  

|接口描述|返回状态信息查询|
|-|-|
|请求地址|/apis/linkingthing.com/example/v1/retcode?node=10.0.0.19&start=1583927639|
|请求方式|HTTP/1.1 GET|
|返回格式|JSON|

- 请求参数意义

|参数名称key|参数value|是否必填|数据类型|备注|
| - |-|-|-|-|
|node|10.0.0.19|是|字符串|要监控的主机ip|
|start|1583927639|是|字符串|表示查询时间|



- 请求示例

|请求内容| curl -4v "10.0.0.19:8081/apis/linkingthing.com/example/v1/retcode?node=10.0.0.19&start=1583935904"|
|-|-|
|响应内容|如下引用|

```
{
  "status": "success",
  "data": {
    "resultType": "matrix",
    "result": [
      {
        "metric": {
          "__name__": "dns_counter",
          "data_type": "NOERROR",
          "instance": "10.0.0.19:8001",
          "job": "dns_exporter"
        },
        "values": [
          [
            1583935904,
            "5"
          ]
        ]
      },
      {
        "metric": {
          "__name__": "dns_counter",
          "data_type": "NXDOMAIN",
          "instance": "10.0.0.19:8001",
          "job": "dns_exporter"
        },
        "values": [
          [
            1583935904,
            "1"
          ]
        ]
      },
      {
        "metric": {
          "__name__": "dns_counter",
          "data_type": "REFUSED",
          "instance": "10.0.0.19:8001",
          "job": "dns_exporter"
        },
        "values": [
          [
            1583935904,
            "0"
          ]
        ]
      },
      {
        "metric": {
          "__name__": "dns_counter",
          "data_type": "SERVFAIL",
          "instance": "10.0.0.19:8001",
          "job": "dns_exporter"
        },
        "values": [
          [
            1583935904,
            "1"
          ]
        ]
      }
    ]
  }
}
```

|响应参数名称key|参数value|数据类型|备注|
| - |-|-|-|-|
|data_type|NOERROR/NXDOMAIN/REFUSED/SERVFAIL|字符串|监控的数据类型|
|values|[1583935904,"1"]|整型+字符串数组|表示查询时间+指标数量(单位个)|

