# 所有接口

| 序号 | 方法   | 接口                                                         | 表单                                                         | 菜单                                   |描述|
| ---- | ------ | ------------------------------------------------------------ | ------------------------------------------------------------ | -------------------------------------- |----|
| 1.    | GET    | /apis/linkingthing.com/example/v1/hists                    | 无                                                           | 节点管理=>DNS仪表盘=>DNS节点的历史信息查询                           |需要添加URL参数:node=10.0.0.19&start=1582699483&end=1582701261&step=323&type=qps
| 2.    | GET    | /apis/linkingthing.com/example/v1/nodes                   | 无                                                           | 节点管理=>DNS仪表盘=>DNS节点的信息查询                           |需要添加URL参数:node=10.0.0.15&type=cpu
| 3.    | GET    | /apis/linkingthing.com/example/v1/retcode?node=10.0.0.19&start=1583927639                  | 无                           | 节点管理=>DNS仪表盘=>解析状态(返回状态)                          |
| 4.    | GET    | /apis/linkingthing.com/example/v1/retcode?node=10.0.0.19&start=1583927639&end=1583928639    | 无                                                           | 节点管理=>DNS仪表盘=> 解析历史信息状态(返回状态历史信息查询)                           |
| 5.    | GET    | /apis/linkingthing.com/example/v1/memhit?node=10.0.0.35&start=1583935904&end=1583936904  | 无                                                           | 节点管理=>DNS仪表盘=>缓存命中历史信息查询                           |

# 接口详细描述
## 1. 节点历史信息查询
- 接口信息  

|接口描述|获取视图信息|
|-|-|
|请求地址|/apis/linkingthing.com/example/v1/hists?node=10.0.0.19&start=1582699483&end=1582701261&step=323&type=qps|
|请求方式|HTTP/1.1 GET|
|返回格式|JSON|

- 请求参数意义

|参数名称key|参数value|是否必填|数据类型|备注|
| - |-|-|-|-|
|type|qps|是|字符串|表示qps主题的内容,其他的主题还有cpu,mem,disk,querys,memhit,recurquerys,分别表示cpu利用率，内存利用率，磁盘利用率,域名解析次数查询,内存命中次数查询,递归次数查询|
|node|10.0.0.19|是|字符串|dns服务器的ip|
|start|1582684206.097|是|字符串|查询开始时间戳|
|end|1582684506.097|是|字符串|查询结束时间戳|
|step|10|是|字符串|查询时间间隔,单位秒|



- 请求示例

|请求内容|http://10.0.0.19:1210/apis/linkingthing.com/example/v1/hists?node=10.0.0.19&start=1582699483&end=1582701261&step=323&type=qps|
|-|-|
|响应内容|如下引用|

```
{
	"status": "success",
	"data": {
		"metric": {
			"node": "10.0.0.19"
		},
		"values": [
			[1582699483, "0"],
			[1582699806, "0"],
			[1582700129, "0"],
			[1582700452, "0"],
			[1582700775, "0"],
			[1582701098, "0"]
		]
	},
	"message": "ok"
}
```
界面元素|响应参数位置|参数类型|参数值举例|
- | -|-|-|
点xy坐标|{"data":{"values": [[1582684206.097, "0"]]}}|string|1582699483, "0"|

## 2. 节点信息查询
- 接口信息  

|接口描述|获取视图信息|
|-|-|
|请求地址|/apis/linkingthing.com/example/v1/nodes?node=10.0.0.15&type=cpu|
|请求方式|HTTP/1.1 GET|
|返回格式|JSON|

- 请求参数意义

|参数名称key|参数value|是否必填|数据类型|备注|
| - |-|-|-|-|
|node|10.0.0.19|是|字符串|进入首页是不传，其他情况传ip地址即可（如10.0.0.15）|
|type|cpu|是|字符串|取值（cpu, mem, disk, all）不传参数，默认是all，不传即可



- 请求示例

|请求内容|http://10.0.0.19:8081/apis/linkingthing.com/example/v1/nodes?node=10.0.0.15&type=cpu|
|-|-|
|响应内容|如下引用|

```
{
	"status": "success",
	"data": {
		"nodes": {},
		"usage": {
			"10.0.0.15": {
				"cpu": "67.40",
				"mem": "29.85",
				"disk": "49.36",
				"qps": "39.76"
			}
		}
	},
	"message": "ok"
}
```
界面元素|响应参数位置|参数类型|参数值举例|
- | -|-|-|
点xy坐标|{"data":{"values": [[1582684206.097, "0"]]}}|string|1582699483, "0"|


## 3. 解析状态信息查询
- 接口信息  

|接口描述|返回状态信息查询|
|-|-|
|请求地址|/apis/linkingthing.com/example/v1/retcode?node=10.0.0.19&start=1583927639|
|请求方式|HTTP/1.1 GET|
|返回格式|JSON|

- 请求参数意义

|参数名称key|参数value|是否必填|数据类型|备注|
| - |-|-|-|-|
|node|10.0.0.19|是|字符串|要监控的主机ip|
|start|1583927639|是|字符串|表示查询时间|



- 请求示例

|请求内容| curl -4v "10.0.0.19:8081/apis/linkingthing.com/example/v1/retcode?node=10.0.0.19&start=1583935904&end=1583936904"|
|-|-|
|响应内容|如下引用|

```
{
  "status": "success",
  "data": {
    "resultType": "matrix",
    "result": [
      {
        "metric": {
          "__name__": "dns_counter",
          "data_type": "NOERROR",
          "instance": "10.0.0.19:8001",
          "job": "dns_exporter"
        },
        "values": [
          [
            1583935904,
            "5"
          ]
        ]
      },
      {
        "metric": {
          "__name__": "dns_counter",
          "data_type": "NXDOMAIN",
          "instance": "10.0.0.19:8001",
          "job": "dns_exporter"
        },
        "values": [
          [
            1583935904,
            "1"
          ]
        ]
      },
      {
        "metric": {
          "__name__": "dns_counter",
          "data_type": "REFUSED",
          "instance": "10.0.0.19:8001",
          "job": "dns_exporter"
        },
        "values": [
          [
            1583935904,
            "0"
          ]
        ]
      },
      {
        "metric": {
          "__name__": "dns_counter",
          "data_type": "SERVFAIL",
          "instance": "10.0.0.19:8001",
          "job": "dns_exporter"
        },
        "values": [
          [
            1583935904,
            "1"
          ]
        ]
      }
    ]
  }
}
```

|响应参数名称key|参数value|数据类型|备注|
| - |-|-|-|-|
|data_type|NOERROR/NXDOMAIN/REFUSED/SERVFAIL|字符串|监控的数据类型|
|values|[1583935904,"1"]|整型+字符串数组|表示查询时间+指标数量(单位个)|

## 4. 解析状态历史信息查询
- 接口信息  

|接口描述|返回状态信息查询|
|-|-|
|请求地址|/apis/linkingthing.com/example/v1/retcode?node=10.0.0.19&start=1583927639&end=1583928639|
|请求方式|HTTP/1.1 GET|
|返回格式|JSON|

- 请求参数意义

|参数名称key|参数value|是否必填|数据类型|备注|
| - |-|-|-|-|
|node|10.0.0.19|是|字符串|要监控的主机ip|
|start|1583927639|是|字符串|表示查询开始时间|
|end|1583927639|是|字符串|表示查询结束时间|



- 请求示例

|请求内容| curl -4v "10.0.0.19:8081/apis/linkingthing.com/example/v1/retcode?node=10.0.0.35&start=1583996974&end=1583997974"|
|-|-|
|响应内容|如下引用|

```
{
	"status": "success",
	"data": {
		"resultType": "matrix",
		"result": [{
			"metric": {
				"__name__": "dns_counter",
				"data_type": "NOERROR",
				"instance": "10.0.0.35:8001",
				"job": "dns_exporter"
			},
			"values": [
				[1583996974, "0"],
				[1583997007, "0"],
				[1583997040, "0"],
				[1583997073, "0"],
				[1583997106, "0"],
				[1583997139, "0"],
				[1583997172, "0"],
				[1583997205, "0"],
				[1583997238, "0"],
				[1583997271, "0"],
				[1583997304, "0"],
				[1583997337, "0"],
				[1583997370, "0"],
				[1583997403, "0"],
				[1583997436, "0"],
				[1583997469, "0"],
				[1583997502, "0"],
				[1583997535, "0"],
				[1583997568, "0"],
				[1583997601, "0"],
				[1583997634, "0"],
				[1583997667, "0"],
				[1583997700, "0"],
				[1583997733, "0"],
				[1583997766, "0"],
				[1583997799, "0"],
				[1583997832, "0"],
				[1583997865, "0"],
				[1583997898, "0"],
				[1583997931, "0"],
				[1583997964, "0"]
			]
		}, {
			"metric": {
				"__name__": "dns_counter",
				"data_type": "NXDOMAIN",
				"instance": "10.0.0.35:8001",
				"job": "dns_exporter"
			},
			"values": [
				[1583996974, "0"],
				[1583997007, "0"],
				[1583997040, "0"],
				[1583997073, "0"],
				[1583997106, "0"],
				[1583997139, "0"],
				[1583997172, "0"],
				[1583997205, "0"],
				[1583997238, "0"],
				[1583997271, "0"],
				[1583997304, "0"],
				[1583997337, "0"],
				[1583997370, "0"],
				[1583997403, "0"],
				[1583997436, "0"],
				[1583997469, "0"],
				[1583997502, "0"],
				[1583997535, "0"],
				[1583997568, "0"],
				[1583997601, "0"],
				[1583997634, "0"],
				[1583997667, "0"],
				[1583997700, "0"],
				[1583997733, "0"],
				[1583997766, "0"],
				[1583997799, "0"],
				[1583997832, "0"],
				[1583997865, "0"],
				[1583997898, "0"],
				[1583997931, "0"],
				[1583997964, "0"]
			]
		}, {
			"metric": {
				"__name__": "dns_counter",
				"data_type": "REFUSED",
				"instance": "10.0.0.35:8001",
				"job": "dns_exporter"
			},
			"values": [
				[1583996974, "0"],
				[1583997007, "0"],
				[1583997040, "0"],
				[1583997073, "0"],
				[1583997106, "0"],
				[1583997139, "0"],
				[1583997172, "0"],
				[1583997205, "0"],
				[1583997238, "0"],
				[1583997271, "0"],
				[1583997304, "0"],
				[1583997337, "0"],
				[1583997370, "0"],
				[1583997403, "0"],
				[1583997436, "0"],
				[1583997469, "0"],
				[1583997502, "0"],
				[1583997535, "0"],
				[1583997568, "0"],
				[1583997601, "0"],
				[1583997634, "0"],
				[1583997667, "0"],
				[1583997700, "0"],
				[1583997733, "0"],
				[1583997766, "0"],
				[1583997799, "0"],
				[1583997832, "0"],
				[1583997865, "0"],
				[1583997898, "0"],
				[1583997931, "0"],
				[1583997964, "0"]
			]
		}, {
			"metric": {
				"__name__": "dns_counter",
				"data_type": "SERVFAIL",
				"instance": "10.0.0.35:8001",
				"job": "dns_exporter"
			},
			"values": [
				[1583996974, "0"],
				[1583997007, "0"],
				[1583997040, "0"],
				[1583997073, "0"],
				[1583997106, "0"],
				[1583997139, "0"],
				[1583997172, "0"],
				[1583997205, "0"],
				[1583997238, "0"],
				[1583997271, "0"],
				[1583997304, "0"],
				[1583997337, "0"],
				[1583997370, "0"],
				[1583997403, "0"],
				[1583997436, "0"],
				[1583997469, "0"],
				[1583997502, "0"],
				[1583997535, "0"],
				[1583997568, "0"],
				[1583997601, "0"],
				[1583997634, "0"],
				[1583997667, "0"],
				[1583997700, "0"],
				[1583997733, "0"],
				[1583997766, "0"],
				[1583997799, "0"],
				[1583997832, "0"],
				[1583997865, "0"],
				[1583997898, "0"],
				[1583997931, "0"],
				[1583997964, "0"]
			]
		}]
	}
}
```

|响应参数名称key|参数value|数据类型|备注|
| - |-|-|-|-|
|data_type|NOERROR/NXDOMAIN/REFUSED/SERVFAIL|字符串|监控的数据类型|
|values|[1583935904,"1"]|整型+字符串数组|表示查询时间+指标数量(单位个)|

|请求内容| curl -4v "10.0.0.19:8081/apis/linkingthing.com/example/v1/retcode?node=10.0.0.19&start=1583935904&end=1583936904"|
## 5. 缓存命中历史信息查询
- 接口信息  

|接口描述|返回状态信息查询|
|-|-|
|请求地址|/apis/linkingthing.com/example/v1/memhit?node=10.0.0.35&start=1583935904&end=1583936904|
|请求方式|HTTP/1.1 GET|
|返回格式|JSON|

- 请求参数意义

|参数名称key|参数value|是否必填|数据类型|备注|
| - |-|-|-|-|
|node|10.0.0.19|是|字符串|要监控的主机ip|
|start|1583927639|是|字符串|表示查询开始时间|
|end|1583927639|是|字符串|表示查询结束时间|



- 请求示例

|请求内容| curl -4v "10.0.0.19:8081/apis/linkingthing.com/example/v1/memhit?node=10.0.0.35&start=1583935904&end=1583936904"|
|-|-|
|响应内容|如下引用|

```
{
	"status": "success",
	"data": {
		"resultType": "matrix",
		"result": [{
			"metric": {
				"__name__": "dns_counter",
				"data_type": "memhit",
				"instance": "10.0.0.35:8001",
				"job": "dns_exporter"
			},
			"values": [
				[1583935904, "5"],
				[1583935937, "5"],
				[1583935970, "5"],
				[1583936003, "5"],
				[1583936036, "5"],
				[1583936069, "5"],
				[1583936102, "5"],
				[1583936135, "5"],
				[1583936168, "5"],
				[1583936201, "5"],
				[1583936234, "5"],
				[1583936267, "5"],
				[1583936300, "5"],
				[1583936333, "5"],
				[1583936366, "5"],
				[1583936399, "5"],
				[1583936432, "5"],
				[1583936465, "5"],
				[1583936498, "5"],
				[1583936531, "5"],
				[1583936564, "5"],
				[1583936597, "5"],
				[1583936630, "5"],
				[1583936663, "5"],
				[1583936696, "5"],
				[1583936729, "5"],
				[1583936762, "5"],
				[1583936795, "5"],
				[1583936828, "5"],
				[1583936861, "5"],
				[1583936894, "5"]
			]
		}, {
			"metric": {
				"__name__": "dns_counter",
				"data_type": "querys",
				"instance": "10.0.0.35:8001",
				"job": "dns_exporter"
			},
			"values": [
				[1583935904, "42"],
				[1583935937, "42"],
				[1583935970, "42"],
				[1583936003, "42"],
				[1583936036, "42"],
				[1583936069, "42"],
				[1583936102, "42"],
				[1583936135, "42"],
				[1583936168, "42"],
				[1583936201, "42"],
				[1583936234, "42"],
				[1583936267, "42"],
				[1583936300, "42"],
				[1583936333, "42"],
				[1583936366, "42"],
				[1583936399, "42"],
				[1583936432, "42"],
				[1583936465, "42"],
				[1583936498, "42"],
				[1583936531, "42"],
				[1583936564, "42"],
				[1583936597, "42"],
				[1583936630, "42"],
				[1583936663, "42"],
				[1583936696, "42"],
				[1583936729, "42"],
				[1583936762, "42"],
				[1583936795, "42"],
				[1583936828, "42"],
				[1583936861, "42"],
				[1583936894, "42"]
			]
		}]
	}
}
```

|响应参数名称key|参数value|数据类型|备注|
| - |-|-|-|-|
|data_type|querys/memhit|字符串|querys表示所以查询的数量,memhit表示命中的数量|
|values|[1583936894, "42"]|整型+字符串数组|表示指标时间+数量(单位个)|